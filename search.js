!function(){var e,t,i,r=document.getElementById("search-key"),n=(document.getElementById("search-local"),document.getElementById("search-form"),document.getElementById("result-mask")),o=document.getElementById("result-wrap"),c=document.getElementById("search-result"),s=document.getElementById("search-tpl").innerHTML;function u(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function a(e,t){u(e,t)||(e.className+=" "+t)}function l(e,t){if(u(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}}function d(e,t){return t.lastIndex=0,t.test(e)}function f(){l(o,"hide"),l(n,"hide")}function h(){a(o,"hide"),a(n,"hide")}function m(e){var t="";e.length?t=e.map(function(e){return function(e,n){return e.replace(/\{\w+\}/g,function(e){var t=e.replace(/\{|\}/g,"");return n[t]||""})}(s,{title:p(e.title,"title"),path:e.path,content:p(e.text,"content")})}).join(""):""==r.value?h():t='<div class="tips"><p>没有找到相关结果!</p></div>',c.innerHTML=t}function p(e,t){var n=r.value,i=e.indexOf(n),o=e.replace(n,"<b>"+n+"</b>");return"title"==t?o:"content"==t&&0<i?o.substr(i-15,45):void 0}function g(e){var t=this.value.trim();if(t){var n=new RegExp(t.replace(/[ ]/g,"|"),"gmi");!function(t){if(i)t(i);else{var e=new XMLHttpRequest;e.open("GET",location.href+"content.json",!0),e.onload=function(){if(200<=this.status&&this.status<300){var e=JSON.parse(this.response||this.responseText);i=e instanceof Array?e:e.posts,t(i)}else console.error(this.statusText)},e.onerror=function(){console.error(this.statusText)},e.send()}}(function(e){m(e.filter(function(e){return function(e,t){return d(e.title,t)||d(e.text,t)}(e,n)}))}),e.preventDefault(),f(),r.onfocus=function(){f()}}else m("")}window.innerWidth?e=parseInt(window.innerWidth):document.body&&document.body.clientWidth&&(e=parseInt(document.body.clientWidth)),window.innerHeight?t=parseInt(window.innerHeight):document.body&&document.body.clientHeight&&(t=parseInt(document.body.clientHeight)),n.style.width=e+"px",n.style.height=t+"px",r.onfocus=function(){r.addEventListener("input",g)},n.onclick=function(){h()}}();